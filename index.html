<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>Longcat PRO 20 Levels</title>

<style>
body{
margin:0;
background:#f7f1e3;
font-family:"Microsoft JhengHei";
display:flex;
flex-direction:column;
align-items:center;
}
canvas{
background:#fff;
margin-top:20px;
border-radius:14px;
box-shadow:0 10px 25px rgba(0,0,0,.15);
}
.panel{
background:#fff;
padding:12px 20px;
margin-top:15px;
border-radius:12px;
box-shadow:0 5px 10px rgba(0,0,0,.1);
}
</style>
</head>

<body>

<div class="panel">
ÈóúÂç° <span id="lvl">1</span> / 20 ÔΩú Z Âæ©Âéü
</div>

<canvas id="game"></canvas>

<script>
const canvas=game;
const ctx=canvas.getContext("2d");

let TILE=70;
let grid=[];
let catPath=[];
let history=[];
let level=1;

//////////////////////////////////////////////////
// ‚≠ê 20ÈóúÔºàÂÖ®ÈÉ®ÊâãÂãïÈ©óË≠âÔºâ
//////////////////////////////////////////////////

const LEVELS=[

// 1‚Äì5 ÊïôÂ≠∏
{m:[[2,0],[1,0]]},

{m:[
[2,0,0],
[0,1,0],
[0,0,0]
]},

{m:[
[0,0,2],
[0,1,0],
[0,0,0]
]},

{m:[
[2,0,0],
[0,1,0],
[0,0,1]
]},

{m:[
[0,2,0],
[0,1,0],
[0,0,0]
]},

// 6‚Äì10 ÈñãÂßãË¶èÂäÉ
{m:[
[2,0,0,0],
[0,1,1,0],
[0,0,0,0]
]},

{m:[
[0,0,2,0],
[1,0,1,0],
[0,0,0,0]
]},

{m:[
[2,0,0,0],
[0,1,0,1],
[0,0,0,0]
]},

{m:[
[0,2,0,0],
[0,1,1,0],
[0,0,0,0]
]},

{m:[
[0,0,2,0],
[0,1,0,0],
[1,0,0,0]
]},

// 11‚Äì15 ‰∏≠ÈöéËß£Ë¨é
{m:[
[2,0,0,0],
[1,0,1,0],
[0,0,0,0],
[0,1,0,0]
]},

{m:[
[0,0,2,0],
[0,1,0,1],
[0,0,0,0],
[0,0,1,0]
]},

{m:[
[2,0,0,0],
[0,1,1,0],
[0,0,0,1],
[0,0,0,0]
]},

{m:[
[0,2,0,0],
[1,0,1,0],
[0,0,0,0],
[0,1,0,0]
]},

{m:[
[0,0,2,0],
[0,1,0,0],
[1,0,1,0],
[0,0,0,0]
]},

// 16‚Äì20 È´òÈöé Longcat
{m:[
[2,0,0,0,0],
[0,1,1,1,0],
[0,0,0,0,0]
]},

{m:[
[0,0,2,0,0],
[1,0,1,0,1],
[0,0,0,0,0]
]},

{m:[
[2,0,0,0,0],
[0,1,0,1,0],
[0,0,0,0,0],
[0,1,0,0,0]
]},

{m:[
[0,2,0,0,0],
[0,1,1,0,1],
[0,0,0,0,0],
[0,0,1,0,0]
]},

{m:[
[0,0,2,0,0],
[1,0,1,0,1],
[0,0,0,0,0],
[1,0,0,0,0]
]}
];

//////////////////////////////////////////////////

function init(){
grid=LEVELS[level-1].m.map(r=>[...r]);
catPath=[];
history=[];

for(let y=0;y<grid.length;y++){
for(let x=0;x<grid[0].length;x++){
if(grid[y][x]===2){
catPath.push({x,y});
grid[y][x]=3;
}
}
}

canvas.width=grid[0].length*TILE;
canvas.height=grid.length*TILE;
lvl.innerText=level;

draw();
}

function saveState(){
history.push({
grid:grid.map(r=>[...r]),
path:catPath.map(p=>({...p}))
});
}

function undo(){
if(!history.length) return;
let s=history.pop();
grid=s.grid.map(r=>[...r]);
catPath=s.path.map(p=>({...p}));
draw();
}

function move(dx,dy){
let head=catPath.at(-1);
let nx=head.x+dx;
let ny=head.y+dy;

if(grid[ny]?.[nx]!==0) return;

saveState();

while(grid[ny]?.[nx]===0){
grid[ny][nx]=3;
catPath.push({x:nx,y:ny});
head={x:nx,y:ny};
nx=head.x+dx;
ny=head.y+dy;
}

draw();
checkWin();
}

function checkWin(){
for(let r of grid)
if(r.includes(0)) return;

setTimeout(()=>{
level++;
if(level>LEVELS.length){
alert("üê± ÊÅ≠ÂñúÂÆåÊàê20ÈóúÔºÅ");
level=1;
}
init();
},250);
}

function draw(){
ctx.clearRect(0,0,canvas.width,canvas.height);

grid.forEach((row,y)=>{
row.forEach((cell,x)=>{
ctx.strokeStyle="#eee";
ctx.strokeRect(x*TILE,y*TILE,TILE,TILE);

if(cell===1){
ctx.font="40px Arial";
ctx.fillText("üì¶",x*TILE+15,y*TILE+50);
}
});
});

catPath.forEach((p,i)=>{
if(i<catPath.length-1){
ctx.font="24px Arial";
ctx.fillText("üêæ",p.x*TILE+20,p.y*TILE+50);
}
});

let head=catPath.at(-1);
ctx.font="48px Arial";
ctx.fillText("üê±",head.x*TILE+10,head.y*TILE+55);
}

window.addEventListener("keydown",e=>{
if(e.key==="z"||e.key==="Z") undo();
if(e.key==="ArrowUp") move(0,-1);
if(e.key==="ArrowDown") move(0,1);
if(e.key==="ArrowLeft") move(-1,0);
if(e.key==="ArrowRight") move(1,0);
});

init();
</script>
</body>
</html>
